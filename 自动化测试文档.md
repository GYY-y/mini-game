# ğŸ§ª æ˜¥èŠ‚å°æ¸¸æˆé›†åˆè‡ªåŠ¨åŒ–æµ‹è¯•æ–‡æ¡£

## ğŸ“‹ æµ‹è¯•æ¦‚è¿°

### æµ‹è¯•ç›®æ ‡
ç¡®ä¿æ˜¥èŠ‚å°æ¸¸æˆé›†åˆçš„åŠŸèƒ½å®Œæ•´æ€§ã€æ€§èƒ½ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒä¸€è‡´æ€§ï¼Œé€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•æ‰‹æ®µä¿è¯ä»£ç è´¨é‡å’Œäº§å“å¯é æ€§ã€‚

### æµ‹è¯•ç­–ç•¥
é‡‡ç”¨åˆ†å±‚æµ‹è¯•ç­–ç•¥ï¼Œä»å•å…ƒæµ‹è¯•åˆ°ç«¯åˆ°ç«¯æµ‹è¯•ï¼Œç¡®ä¿å„ä¸ªå±‚çº§çš„ä»£ç è´¨é‡å’ŒåŠŸèƒ½æ­£ç¡®æ€§ã€‚

### æµ‹è¯•å·¥å…·æ ˆ
- **å•å…ƒæµ‹è¯•**: Vitest + Vue Test Utils
- **ç»„ä»¶æµ‹è¯•**: @vue/test-utils + @testing-library/vue
- **ç«¯åˆ°ç«¯æµ‹è¯•**: Playwright
- **æ€§èƒ½æµ‹è¯•**: Lighthouse CI
- **ä»£ç è¦†ç›–ç‡**: c8/v8
- **Mockæ•°æ®**: MSW (Mock Service Worker)

## ğŸ—ï¸ æµ‹è¯•æ¶æ„

### æµ‹è¯•ç›®å½•ç»“æ„
```
tests/
â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â”‚   â”œâ”€â”€ GameCard.spec.js
â”‚   â”‚   â”‚   â”œâ”€â”€ Navigation.spec.js
â”‚   â”‚   â”‚   â””â”€â”€ SoundToggle.spec.js
â”‚   â”‚   â””â”€â”€ games/
â”‚   â”‚       â”œâ”€â”€ DiceGame/
â”‚   â”‚       â”‚   â”œâ”€â”€ DiceGame.spec.js
â”‚   â”‚       â”‚   â”œâ”€â”€ Dice.spec.js
â”‚   â”‚       â”‚   â””â”€â”€ DiceConfig.spec.js
â”‚   â”‚       â”œâ”€â”€ CoinGame/
â”‚   â”‚       â”‚   â”œâ”€â”€ CoinGame.spec.js
â”‚   â”‚       â”‚   â”œâ”€â”€ Coin.spec.js
â”‚   â”‚       â”‚   â””â”€â”€ CoinHistory.spec.js
â”‚   â”‚       â””â”€â”€ WheelGame/
â”‚   â”‚           â”œâ”€â”€ WheelGame.spec.js
â”‚   â”‚           â”œâ”€â”€ Wheel.spec.js
â”‚   â”‚           â””â”€â”€ WheelConfig.spec.js
â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â”œâ”€â”€ games.spec.js
â”‚   â”‚   â”œâ”€â”€ settings.spec.js
â”‚   â”‚   â””â”€â”€ user.spec.js
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ animation.spec.js
â”‚   â”‚   â”œâ”€â”€ storage.spec.js
â”‚   â”‚   â””â”€â”€ gameLogic.spec.js
â”‚   â””â”€â”€ views/
â”‚       â”œâ”€â”€ Home.spec.js
â”‚       â”œâ”€â”€ GameHub.spec.js
â”‚       â””â”€â”€ Settings.spec.js
â”œâ”€â”€ integration/             # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ games/
â”‚   â”‚   â”œâ”€â”€ dice-game.integration.spec.js
â”‚   â”‚   â”œâ”€â”€ coin-game.integration.spec.js
â”‚   â”‚   â””â”€â”€ wheel-game.integration.spec.js
â”‚   â””â”€â”€ navigation/
â”‚       â””â”€â”€ router.integration.spec.js
â”œâ”€â”€ e2e/                     # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚   â”œâ”€â”€ fixtures/
â”‚   â”‚   â””â”€â”€ testData.json
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ home.spec.js
â”‚   â”‚   â”œâ”€â”€ dice-game.spec.js
â”‚   â”‚   â”œâ”€â”€ coin-game.spec.js
â”‚   â”‚   â”œâ”€â”€ wheel-game.spec.js
â”‚   â”‚   â””â”€â”€ settings.spec.js
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ test-helpers.js
â”‚       â””â”€â”€ custom-commands.js
â”œâ”€â”€ performance/             # æ€§èƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ lighthouse.config.js
â”‚   â””â”€â”€ performance.spec.js
â”œâ”€â”€ accessibility/           # å¯è®¿é—®æ€§æµ‹è¯•
â”‚   â””â”€â”€ a11y.spec.js
â”œâ”€â”€ __mocks__/               # Mockæ–‡ä»¶
â”‚   â”œâ”€â”€ localStorage.js
â”‚   â”œâ”€â”€ audio.js
â”‚   â””â”€â”€ canvas.js
â””â”€â”€ utils/                   # æµ‹è¯•å·¥å…·å‡½æ•°
    â”œâ”€â”€ test-utils.js
    â”œâ”€â”€ mock-data.js
    â””â”€â”€ assertions.js
```

## ğŸ§ª å•å…ƒæµ‹è¯•è§„èŒƒ

### ç»„ä»¶æµ‹è¯•æ¨¡æ¿

#### åŸºç¡€ç»„ä»¶æµ‹è¯•
```javascript
// tests/unit/components/common/GameCard.spec.js
import { describe, it, expect } from 'vitest'
import { mount } from '@vue/test-utils'
import GameCard from '@/components/common/GameCard.vue'

describe('GameCard.vue', () => {
  const mockProps = {
    title: 'æ‘‡éª°å­',
    description: 'ç»å…¸æ‘‡éª°å­æ¸¸æˆ',
    icon: 'ğŸ²',
    color: '#DC143C'
  }

  it('åº”è¯¥æ­£ç¡®æ¸²æŸ“æ¸¸æˆæ ‡é¢˜', () => {
    const wrapper = mount(GameCard, {
      props: mockProps
    })
    
    expect(wrapper.find('.game-card__title').text()).toBe('æ‘‡éª°å­')
  })

  it('åº”è¯¥åœ¨ç‚¹å‡»æ—¶è§¦å‘selectäº‹ä»¶', async () => {
    const wrapper = mount(GameCard, {
      props: mockProps
    })
    
    await wrapper.find('.game-card').trigger('click')
    
    expect(wrapper.emitted('select')).toBeTruthy()
    expect(wrapper.emitted('select')[0]).toEqual(['dice'])
  })

  it('åº”è¯¥æ­£ç¡®æ˜¾ç¤ºæ¸¸æˆå›¾æ ‡', () => {
    const wrapper = mount(GameCard, {
      props: mockProps
    })
    
    expect(wrapper.find('.game-card__icon').text()).toBe('ğŸ²')
  })

  it('åº”è¯¥åº”ç”¨æ­£ç¡®çš„ä¸»é¢˜é¢œè‰²', () => {
    const wrapper = mount(GameCard, {
      props: mockProps
    })
    
    expect(wrapper.find('.game-card').attributes('style')).toContain('--theme-color: #DC143C')
  })
})
```

#### æ¸¸æˆé€»è¾‘ç»„ä»¶æµ‹è¯•
```javascript
// tests/unit/components/games/DiceGame/Dice.spec.js
import { describe, it, expect, vi } from 'vitest'
import { mount } from '@vue/test-utils'
import Dice from '@/components/games/DiceGame/Dice.vue'

describe('Dice.vue', () => {
  beforeEach(() => {
    vi.useFakeTimers()
  })

  afterEach(() => {
    vi.restoreAllMocks()
  })

  it('åº”è¯¥æ˜¾ç¤ºæ­£ç¡®çš„éª°å­ç‚¹æ•°', () => {
    const wrapper = mount(Dice, {
      props: { value: 6 }
    })
    
    expect(wrapper.find('.dice').classes()).toContain('dice--6')
    expect(wrapper.findAll('.dice__dot').length).toBe(6)
  })

  it('åº”è¯¥åœ¨æ‘‡åŠ¨æ—¶æ˜¾ç¤ºåŠ¨ç”»', async () => {
    const wrapper = mount(Dice, {
      props: { value: 1, isRolling: true }
    })
    
    expect(wrapper.find('.dice').classes()).toContain('dice--rolling')
  })

  it('åº”è¯¥åœ¨åŠ¨ç”»ç»“æŸåæ˜¾ç¤ºæ–°å€¼', async () => {
    const wrapper = mount(Dice, {
      props: { value: 1, isRolling: false }
    })
    
    await wrapper.setProps({ isRolling: true })
    vi.advanceTimersByTime(2000)
    await wrapper.setProps({ isRolling: false, value: 6 })
    
    expect(wrapper.find('.dice').classes()).toContain('dice--6')
  })

  it('åº”è¯¥ç”Ÿæˆ1-6ä¹‹é—´çš„éšæœºå€¼', () => {
    const wrapper = mount(Dice)
    const values = []
    
    for (let i = 0; i < 100; i++) {
      values.push(wrapper.vm.roll())
    }
    
    values.forEach(value => {
      expect(value).toBeGreaterThanOrEqual(1)
      expect(value).toBeLessThanOrEqual(6)
    })
  })
})
```

### çŠ¶æ€ç®¡ç†æµ‹è¯•
```javascript
// tests/unit/stores/games.spec.js
import { describe, it, expect, beforeEach } from 'vitest'
import { setActivePinia, createPinia } from 'pinia'
import { useGamesStore } from '@/stores/games'

describe('Games Store', () => {
  beforeEach(() => {
    setActivePinia(createPinia())
  })

  it('åº”è¯¥æœ‰æ­£ç¡®çš„åˆå§‹çŠ¶æ€', () => {
    const store = useGamesStore()
    
    expect(store.currentGame).toBeNull()
    expect(store.gameHistory).toEqual({
      dice: [],
      coin: [],
      wheel: []
    })
  })

  it('åº”è¯¥èƒ½å¤Ÿè®¾ç½®å½“å‰æ¸¸æˆ', () => {
    const store = useGamesStore()
    
    store.setCurrentGame('dice')
    
    expect(store.currentGame).toBe('dice')
  })

  it('åº”è¯¥èƒ½å¤Ÿæ·»åŠ æ¸¸æˆç»“æœ', () => {
    const store = useGamesStore()
    const result = {
      timestamp: Date.now(),
      values: [3, 5, 2],
      sum: 10
    }
    
    store.addGameResult('dice', result)
    
    expect(store.gameHistory.dice).toHaveLength(1)
    expect(store.gameHistory.dice[0]).toEqual(result)
  })

  it('åº”è¯¥èƒ½å¤Ÿæ¸…é™¤å†å²è®°å½•', () => {
    const store = useGamesStore()
    
    // æ·»åŠ ä¸€äº›å†å²è®°å½•
    store.addGameResult('dice', { values: [1, 2, 3] })
    store.addGameResult('coin', { result: 'heads' })
    
    // æ¸…é™¤éª°å­å†å²
    store.clearHistory('dice')
    
    expect(store.gameHistory.dice).toHaveLength(0)
    expect(store.gameHistory.coin).toHaveLength(1)
  })
})
```

### å·¥å…·å‡½æ•°æµ‹è¯•
```javascript
// tests/unit/utils/gameLogic.spec.js
import { describe, it, expect } from 'vitest'
import { 
  generateRandomNumber, 
  calculateProbability, 
  validateDiceConfig,
  selectWheelPrize 
} from '@/utils/gameLogic'

describe('Game Logic Utils', () => {
  describe('generateRandomNumber', () => {
    it('åº”è¯¥ç”ŸæˆæŒ‡å®šèŒƒå›´çš„éšæœºæ•°', () => {
      const min = 1
      const max = 6
      
      for (let i = 0; i < 100; i++) {
        const result = generateRandomNumber(min, max)
        expect(result).toBeGreaterThanOrEqual(min)
        expect(result).toBeLessThanOrEqual(max)
      }
    })

    it('åº”è¯¥è¿”å›æ•´æ•°ç»“æœ', () => {
      const result = generateRandomNumber(1, 10)
      expect(Number.isInteger(result)).toBe(true)
    })
  })

  describe('calculateProbability', () => {
    it('åº”è¯¥æ­£ç¡®è®¡ç®—æ¦‚ç‡', () => {
      const stats = { heads: 52, tails: 48 }
      const probability = calculateProbability(stats, 'heads')
      
      expect(probability).toBeCloseTo(0.52, 2)
    })

    it('åº”è¯¥å¤„ç†é›¶é™¤æƒ…å†µ', () => {
      const stats = { heads: 0, tails: 0 }
      
      expect(() => calculateProbability(stats, 'heads')).not.toThrow()
    })
  })

  describe('validateDiceConfig', () => {
    it('åº”è¯¥éªŒè¯æœ‰æ•ˆçš„éª°å­é…ç½®', () => {
      const validConfig = { count: 3, animationSpeed: 'normal' }
      
      expect(validateDiceConfig(validConfig)).toBe(true)
    })

    it('åº”è¯¥æ‹’ç»æ— æ•ˆçš„éª°å­æ•°é‡', () => {
      const invalidConfigs = [
        { count: 0 },
        { count: 7 },
        { count: -1 }
      ]
      
      invalidConfigs.forEach(config => {
        expect(validateDiceConfig(config)).toBe(false)
      })
    })
  })

  describe('selectWheelPrize', () => {
    it('åº”è¯¥æ ¹æ®æƒé‡æ­£ç¡®é€‰æ‹©å¥–å“', () => {
      const segments = [
        { text: 'ä¸€ç­‰å¥–', weight: 10 },
        { text: 'äºŒç­‰å¥–', weight: 20 },
        { text: 'ä¸‰ç­‰å¥–', weight: 30 }
      ]
      
      // Mock Math.random for predictable results
      const mockRandom = vi.fn()
      global.Math.random = mockRandom
      
      // æµ‹è¯•é€‰ä¸­ä¸€ç­‰å¥–çš„æƒ…å†µ
      mockRandom.mockReturnValue(0.05)
      const result1 = selectWheelPrize(segments)
      expect(result1.text).toBe('ä¸€ç­‰å¥–')
      
      // æµ‹è¯•é€‰ä¸­äºŒç­‰å¥–çš„æƒ…å†µ
      mockRandom.mockReturnValue(0.15)
      const result2 = selectWheelPrize(segments)
      expect(result2.text).toBe('äºŒç­‰å¥–')
    })
  })
})
```

## ğŸ”„ é›†æˆæµ‹è¯•è§„èŒƒ

### æ¸¸æˆæµç¨‹é›†æˆæµ‹è¯•
```javascript
// tests/integration/games/dice-game.integration.spec.js
import { describe, it, expect, beforeEach, vi } from 'vitest'
import { mount } from '@vue/test-utils'
import { createPinia, setActivePinia } from 'pinia'
import DiceGame from '@/components/games/DiceGame/DiceGame.vue'

describe('Dice Game Integration', () => {
  let wrapper
  let store

  beforeEach(() => {
    setActivePinia(createPinia())
    store = createPinia()
    
    // Mock audio context
    global.Audio = vi.fn().mockImplementation(() => ({
      play: vi.fn(),
      pause: vi.fn(),
      currentTime: 0
    }))
    
    wrapper = mount(DiceGame, {
      global: {
        plugins: [store]
      }
    })
  })

  it('åº”è¯¥å®Œæˆå®Œæ•´çš„æ‘‡éª°å­æµç¨‹', async () => {
    // åˆå§‹çŠ¶æ€æ£€æŸ¥
    expect(wrapper.findAll('.dice')).toHaveLength(2) // é»˜è®¤2ä¸ªéª°å­
    expect(wrapper.find('.roll-button').text()).toBe('æ‘‡éª°å­')
    
    // ç‚¹å‡»æ‘‡éª°å­æŒ‰é’®
    await wrapper.find('.roll-button').trigger('click')
    
    // éªŒè¯åŠ¨ç”»çŠ¶æ€
    expect(wrapper.vm.isRolling).toBe(true)
    expect(wrapper.findAll('.dice--rolling')).toHaveLength(2)
    
    // ç­‰å¾…åŠ¨ç”»ç»“æŸ
    vi.advanceTimersByTime(2000)
    await wrapper.vm.$nextTick()
    
    // éªŒè¯ç»“æœ
    expect(wrapper.vm.isRolling).toBe(false)
    expect(wrapper.findAll('.dice--rolling')).toHaveLength(0)
    expect(wrapper.vm.currentValues).toHaveLength(2)
    
    // éªŒè¯å†å²è®°å½•
    expect(wrapper.vm.history).toHaveLength(1)
    expect(wrapper.vm.history[0]).toHaveProperty('values')
    expect(wrapper.vm.history[0]).toHaveProperty('sum')
  })

  it('åº”è¯¥èƒ½å¤Ÿé…ç½®éª°å­æ•°é‡', async () => {
    // æ‰“å¼€é…ç½®é¢æ¿
    await wrapper.find('.config-button').trigger('click')
    
    // è®¾ç½®éª°å­æ•°é‡ä¸º4
    const diceCountInput = wrapper.find('.dice-count input')
    await diceCountInput.setValue(4)
    
    // ä¿å­˜é…ç½®
    await wrapper.find('.save-config').trigger('click')
    
    // éªŒè¯éª°å­æ•°é‡æ›´æ–°
    expect(wrapper.findAll('.dice')).toHaveLength(4)
  })

  it('åº”è¯¥èƒ½å¤Ÿåˆ‡æ¢éŸ³æ•ˆ', async () => {
    const soundToggle = wrapper.find('.sound-toggle')
    
    // åˆå§‹çŠ¶æ€éŸ³æ•ˆå¼€å¯
    expect(store.soundEnabled).toBe(true)
    
    // åˆ‡æ¢éŸ³æ•ˆ
    await soundToggle.trigger('click')
    
    expect(store.soundEnabled).toBe(false)
  })
})
```

## ğŸŒ ç«¯åˆ°ç«¯æµ‹è¯•è§„èŒƒ

### Playwright E2Eæµ‹è¯•
```javascript
// tests/e2e/pages/dice-game.spec.js
import { test, expect } from '@playwright/test'

test.describe('æ‘‡éª°å­æ¸¸æˆ E2E æµ‹è¯•', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/')
    await page.click('[data-testid="dice-game-card"]')
  })

  test('åº”è¯¥èƒ½å¤Ÿå®Œæˆå®Œæ•´çš„æ¸¸æˆæµç¨‹', async ({ page }) => {
    // ç­‰å¾…æ¸¸æˆé¡µé¢åŠ è½½
    await expect(page.locator('.dice-game')).toBeVisible()
    
    // æ£€æŸ¥åˆå§‹çŠ¶æ€
    await expect(page.locator('.dice')).toHaveCount(2)
    await expect(page.locator('.roll-button')).toBeVisible()
    
    // ç‚¹å‡»æ‘‡éª°å­
    await page.click('.roll-button')
    
    // éªŒè¯åŠ¨ç”»çŠ¶æ€
    await expect(page.locator('.dice--rolling')).toHaveCount(2)
    await expect(page.locator('.roll-button')).toBeDisabled()
    
    // ç­‰å¾…åŠ¨ç”»å®Œæˆ
    await page.waitForTimeout(2000)
    
    // éªŒè¯ç»“æœæ˜¾ç¤º
    await expect(page.locator('.dice--rolling')).toHaveCount(0)
    await expect(page.locator('.roll-button')).not.toBeDisabled()
    await expect(page.locator('.game-result')).toBeVisible()
    
    // éªŒè¯å†å²è®°å½•
    await page.click('.history-tab')
    await expect(page.locator('.history-item')).toHaveCount(1)
  })

  test('åº”è¯¥èƒ½å¤Ÿé…ç½®æ¸¸æˆå‚æ•°', async ({ page }) => {
    // æ‰“å¼€é…ç½®é¢æ¿
    await page.click('.config-button')
    await expect(page.locator('.config-panel')).toBeVisible()
    
    // ä¿®æ”¹éª°å­æ•°é‡
    await page.fill('.dice-count input', '4')
    
    // ä¿®æ”¹åŠ¨ç”»é€Ÿåº¦
    await page.selectOption('.animation-speed select', 'slow')
    
    // ä¿å­˜é…ç½®
    await page.click('.save-config')
    
    // éªŒè¯é…ç½®ç”Ÿæ•ˆ
    await expect(page.locator('.dice')).toHaveCount(4)
    await expect(page.locator('.config-panel')).not.toBeVisible()
  })

  test('åº”è¯¥èƒ½å¤Ÿåœ¨ä¸åŒè®¾å¤‡å°ºå¯¸ä¸‹æ­£å¸¸æ˜¾ç¤º', async ({ page }) => {
    // æµ‹è¯•æ‰‹æœºè§†å›¾
    await page.setViewportSize({ width: 375, height: 667 })
    await expect(page.locator('.dice-game')).toBeVisible()
    await expect(page.locator('.dice')).toHaveCount(2)
    
    // æµ‹è¯•å¹³æ¿è§†å›¾
    await page.setViewportSize({ width: 768, height: 1024 })
    await expect(page.locator('.dice-game')).toBeVisible()
    
    // æµ‹è¯•æ¡Œé¢è§†å›¾
    await page.setViewportSize({ width: 1920, height: 1080 })
    await expect(page.locator('.dice-game')).toBeVisible()
  })

  test('åº”è¯¥æ”¯æŒé”®ç›˜å¯¼èˆª', async ({ page }) => {
    // Tabå¯¼èˆªåˆ°æ‘‡éª°å­æŒ‰é’®
    await page.keyboard.press('Tab')
    await expect(page.locator('.roll-button')).toBeFocused()
    
    // Enteré”®è§¦å‘æ‘‡éª°å­
    await page.keyboard.press('Enter')
    await expect(page.locator('.dice--rolling')).toHaveCount(2)
  })
})
```

### å¤šæ¸¸æˆæµç¨‹æµ‹è¯•
```javascript
// tests/e2e/pages/game-navigation.spec.js
import { test, expect } from '@playwright/test'

test.describe('æ¸¸æˆå¯¼èˆª E2E æµ‹è¯•', () => {
  test('åº”è¯¥èƒ½å¤Ÿåœ¨ä¸åŒæ¸¸æˆé—´åˆ‡æ¢', async ({ page }) => {
    await page.goto('/')
    
    // å¯¼èˆªåˆ°æ‘‡éª°å­æ¸¸æˆ
    await page.click('[data-testid="dice-game-card"]')
    await expect(page.locator('.dice-game')).toBeVisible()
    
    // è¿”å›é¦–é¡µ
    await page.click('.back-button')
    await expect(page.locator('.home-page')).toBeVisible()
    
    // å¯¼èˆªåˆ°æŠ›ç¡¬å¸æ¸¸æˆ
    await page.click('[data-testid="coin-game-card"]')
    await expect(page.locator('.coin-game')).toBeVisible()
    
    // ç›´æ¥å¯¼èˆªåˆ°å¤§è½¬ç›˜æ¸¸æˆ
    await page.goto('/wheel')
    await expect(page.locator('.wheel-game')).toBeVisible()
  })

  test('åº”è¯¥èƒ½å¤Ÿè®°ä½ç”¨æˆ·è®¾ç½®', async ({ page }) => {
    await page.goto('/')
    
    // è®¾ç½®éŸ³æ•ˆå…³é—­
    await page.click('.settings-button')
    await page.click('.sound-toggle input')
    await page.click('.save-settings')
    
    // åˆ·æ–°é¡µé¢
    await page.reload()
    
    // éªŒè¯è®¾ç½®å·²ä¿å­˜
    await page.click('.settings-button')
    await expect(page.locator('.sound-toggle input')).not.toBeChecked()
  })
})
```

## âš¡ æ€§èƒ½æµ‹è¯•è§„èŒƒ

### Lighthouseæ€§èƒ½æµ‹è¯•
```javascript
// tests/performance/performance.spec.js
import { test } from '@playwright/test'

test.describe('æ€§èƒ½æµ‹è¯•', () => {
  test('é¦–é¡µæ€§èƒ½æŒ‡æ ‡è¾¾æ ‡', async ({ page }) => {
    await page.goto('/')
    
    // ç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½
    await page.waitForLoadState('networkidle')
    
    // è¿è¡ŒLighthouseå®¡è®¡
    const lighthouseResult = await page.evaluate(() => {
      return new Promise((resolve) => {
        chrome.runtime.sendMessage(
          'lfjcdagjciobcoebgfckfboafgacnehf',
          { type: 'lighthouse', url: window.location.href },
          resolve
        )
      })
    })
    
    // éªŒè¯æ€§èƒ½æŒ‡æ ‡
    expect(lighthouseResult.lhr.categories.performance.score).toBeGreaterThan(0.9)
    expect(lighthouseResult.lhr.audits['first-contentful-paint'].numericValue).toBeLessThan(2000)
    expect(lighthouseResult.lhr.audits['largest-contentful-paint'].numericValue).toBeLessThan(2500)
  })

  test('æ¸¸æˆåŠ¨ç”»æ€§èƒ½æµ‹è¯•', async ({ page }) => {
    await page.goto('/dice')
    
    // å¼€å§‹æ€§èƒ½ç›‘æ§
    await page.evaluate(() => {
      performance.mark('animation-start')
    })
    
    // è§¦å‘åŠ¨ç”»
    await page.click('.roll-button')
    
    // ç­‰å¾…åŠ¨ç”»å®Œæˆ
    await page.waitForSelector('.dice:not(.dice--rolling)', { timeout: 5000 })
    
    // ç»“æŸæ€§èƒ½ç›‘æ§
    const animationMetrics = await page.evaluate(() => {
      performance.mark('animation-end')
      performance.measure('animation-duration', 'animation-start', 'animation-end')
      const measures = performance.getEntriesByName('animation-duration')
      return measures[0].duration
    })
    
    // éªŒè¯åŠ¨ç”»æ—¶é•¿åœ¨åˆç†èŒƒå›´å†…
    expect(animationMetrics).toBeGreaterThan(1500)
    expect(animationMetrics).toBeLessThan(2500)
  })
})
```

## â™¿ å¯è®¿é—®æ€§æµ‹è¯•è§„èŒƒ

```javascript
// tests/accessibility/a11y.spec.js
import { test, expect } from '@playwright/test'
import { injectAxe, checkA11y } from 'axe-playwright'

test.describe('å¯è®¿é—®æ€§æµ‹è¯•', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/')
    await injectAxe(page)
  })

  test('é¦–é¡µåº”è¯¥é€šè¿‡å¯è®¿é—®æ€§æ£€æŸ¥', async ({ page }) => {
    await checkA11y(page)
  })

  test('æ‘‡éª°å­æ¸¸æˆåº”è¯¥æ”¯æŒé”®ç›˜æ“ä½œ', async ({ page }) => {
    await page.click('[data-testid="dice-game-card"]')
    
    // Tabå¯¼èˆªåˆ°æ‘‡éª°å­æŒ‰é’®
    await page.keyboard.press('Tab')
    await expect(page.locator('.roll-button')).toBeFocused()
    
    // Enteré”®è§¦å‘æ¸¸æˆ
    await page.keyboard.press('Enter')
    await expect(page.locator('.dice--rolling')).toHaveCount(2)
  })

  test('é¢œè‰²å¯¹æ¯”åº¦åº”è¯¥ç¬¦åˆæ ‡å‡†', async ({ page }) => {
    await checkA11y(page, null, {
      rules: {
        'color-contrast': { enabled: true }
      }
    })
  })

  test('åº”è¯¥æœ‰æ­£ç¡®çš„ARIAæ ‡ç­¾', async ({ page }) => {
    await page.click('[data-testid="dice-game-card"]')
    
    const rollButton = page.locator('.roll-button')
    await expect(rollButton).toHaveAttribute('aria-label')
    await expect(rollButton).toHaveAttribute('role', 'button')
  })
})
```

## ğŸ“Š æµ‹è¯•è¦†ç›–ç‡

### è¦†ç›–ç‡é…ç½®
```javascript
// vitest.config.js
import { defineConfig } from 'vitest/config'
import vue from '@vitejs/plugin-vue'
import path from 'path'

export default defineConfig({
  plugins: [vue()],
  test: {
    coverage: {
      provider: 'c8',
      reporter: ['text', 'html', 'json'],
      exclude: [
        'node_modules/',
        'tests/',
        '**/*.d.ts',
        '**/*.config.*',
        'src/assets/'
      ],
      thresholds: {
        global: {
          branches: 80,
          functions: 80,
          lines: 80,
          statements: 80
        }
      }
    }
  },
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src')
    }
  }
})
```

### è¦†ç›–ç‡æŠ¥å‘Š
```bash
# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# æŸ¥çœ‹HTMLè¦†ç›–ç‡æŠ¥å‘Š
open coverage/index.html

# æ£€æŸ¥è¦†ç›–ç‡é˜ˆå€¼
npm run test:coverage:check
```

## ğŸš€ CI/CDé›†æˆ

### GitHub Actionså·¥ä½œæµ
```yaml
# .github/workflows/test.yml
name: æµ‹è¯•æµæ°´çº¿

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    strategy:
      matrix:
        node-version: [18.x, 20.x]
    
    steps:
    - uses: actions/checkout@v3
    
    - name: è®¾ç½®Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v3
      with:
        node-version: ${{ matrix.node-version }}
        cache: 'npm'
    
    - name: å®‰è£…ä¾èµ–
      run: npm ci
    
    - name: è¿è¡Œå•å…ƒæµ‹è¯•
      run: npm run test:unit
    
    - name: è¿è¡Œç»„ä»¶æµ‹è¯•
      run: npm run test:component
    
    - name: è¿è¡ŒE2Eæµ‹è¯•
      run: npm run test:e2e
    
    - name: ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
      run: npm run test:coverage
    
    - name: ä¸Šä¼ è¦†ç›–ç‡åˆ°Codecov
      uses: codecov/codecov-action@v3
      with:
        file: ./coverage/lcov.info
    
    - name: è¿è¡Œæ€§èƒ½æµ‹è¯•
      run: npm run test:performance
    
    - name: è¿è¡Œå¯è®¿é—®æ€§æµ‹è¯•
      run: npm run test:a11y

  build:
    runs-on: ubuntu-latest
    needs: test
    
    steps:
    - uses: actions/checkout@v3
    
    - name: è®¾ç½®Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '20.x'
        cache: 'npm'
    
    - name: å®‰è£…ä¾èµ–
      run: npm ci
    
    - name: æ„å»ºé¡¹ç›®
      run: npm run build
    
    - name: è¿è¡Œæ„å»ºåçš„æµ‹è¯•
      run: npm run test:preview
```

## ğŸ“‹ æµ‹è¯•æ‰§è¡ŒæŒ‡å—

### æœ¬åœ°æµ‹è¯•å‘½ä»¤
```bash
# å®‰è£…ä¾èµ–
npm install

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test

# è¿è¡Œå•å…ƒæµ‹è¯•
npm run test:unit

# è¿è¡Œç»„ä»¶æµ‹è¯•
npm run test:component

# è¿è¡Œé›†æˆæµ‹è¯•
npm run test:integration

# è¿è¡ŒE2Eæµ‹è¯•
npm run test:e2e

# è¿è¡Œæ€§èƒ½æµ‹è¯•
npm run test:performance

# è¿è¡Œå¯è®¿é—®æ€§æµ‹è¯•
npm run test:a11y

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# ç›‘å¬æ¨¡å¼è¿è¡Œæµ‹è¯•
npm run test:watch

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
npm run test:unit -- Dice.spec.js
```

### æµ‹è¯•æœ€ä½³å®è·µ

1. **æµ‹è¯•å‘½å**: ä½¿ç”¨æè¿°æ€§çš„æµ‹è¯•åç§°
2. **æµ‹è¯•éš”ç¦»**: æ¯ä¸ªæµ‹è¯•åº”è¯¥ç‹¬ç«‹è¿è¡Œ
3. **Mockä½¿ç”¨**: åˆç†ä½¿ç”¨Mocké¿å…å¤–éƒ¨ä¾èµ–
4. **æ–­è¨€æ¸…æ™°**: ä½¿ç”¨æ¸…æ™°çš„æ–­è¨€ä¿¡æ¯
5. **æµ‹è¯•æ•°æ®**: ä½¿ç”¨ç»Ÿä¸€çš„æµ‹è¯•æ•°æ®ç®¡ç†
6. **ç»´æŠ¤æ€§**: å®šæœŸæ›´æ–°å’Œæ¸…ç†æµ‹è¯•ä»£ç 

### å¸¸è§é—®é¢˜è§£å†³

1. **å¼‚æ­¥æµ‹è¯•**: ä½¿ç”¨async/awaitå¤„ç†å¼‚æ­¥æ“ä½œ
2. **æ—¶é—´æ§åˆ¶**: ä½¿ç”¨vi.useFakeTimers()æ§åˆ¶æ—¶é—´
3. **DOMæ›´æ–°**: ç­‰å¾…Vueçš„å“åº”å¼æ›´æ–°å®Œæˆ
4. **äº‹ä»¶è§¦å‘**: ä½¿ç”¨wrapper.trigger()æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œ
5. **çŠ¶æ€ç®¡ç†**: åœ¨æµ‹è¯•ä¸­æ­£ç¡®åˆå§‹åŒ–Pinia store

---

æœ¬æµ‹è¯•æ–‡æ¡£å°†ä½œä¸ºé¡¹ç›®è´¨é‡ä¿è¯çš„é‡è¦æŒ‡å¯¼ï¼Œç¡®ä¿äº§å“çš„ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒã€‚æ‰€æœ‰æ–°åŠŸèƒ½çš„å¼€å‘éƒ½åº”è¯¥åŒ…å«ç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹ã€‚